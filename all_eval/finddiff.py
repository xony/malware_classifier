#!/usr/bin/env python

#
# This file checks if there are any feature vectors which occur in the first file but not in the second
#


import sys, numpy as np

malwarefile, goodwarefile = sys.argv[1], sys.argv[2]

with open(malwarefile) as mal, open(goodwarefile) as goodw:
    ## init vars
    mal_vectors = []
    goodw_vectors = []
    numbers = []
    ## start to read all the feature vectors of the malware samples
    for line in mal:
	mal_vectors.append( [int(i.split(":")[1]) for i in line.split()[1:]] )
    for line in goodw:
	goodw_vectors.append( [int(i.split(":")[1]) for i in line.split()[1:]] )

mal_sum =np.sum(mal_vectors, axis=0)
goodw_sum = np.sum(goodw_vectors, axis=0)

for i, mal_element in enumerate(mal_sum):
    if mal_element != 0 and goodw_sum[i] == 0:
	print "Feature nr ", i+1, " is found within the malware but not in the goodware."
    
